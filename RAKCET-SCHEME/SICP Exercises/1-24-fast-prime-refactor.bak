#lang sicp

;exercise 1.23
(define (smallest-divisor n)
  
  (find-divisor n 2)
  )

(define (next test-divisor)
  (if (= test-divisor 2)
      3
      (+ test-divisor 2)
      )
  )

(define (find-divisor n test-divisor)
  (cond ((> (square test-divisor) n) n)
        ((divides? test-divisor n) test-divisor)
        (else (find-divisor n (next test-divisor))))
  )

(define (square n)
  (* 2 n)
  )

(define (divides? a b)
  (= (remainder a b) 0)
  )

(define (prime? n)
  (= n (smallest-divisor n))
  )

;;SEARCH TEST

(define (timed-prime-test n) 
  (newline) 
  (display n) 
  (start-prime-test n (runtime))
)

(define (start-prime-test n start-time) 
(if (prime? n) 
(report-prime (- (runtime) start-time))))

(define (report-prime elapsed-time) 
(display " *** ")
(display elapsed-time))



(timed-prime-test 1001)
(timed-prime-test 1003)
(timed-prime-test 1005)

(timed-prime-test 10001)
(timed-prime-test 10003)
(timed-prime-test 10005)

;previous exercise 1.22 result
;1001 *** 14
;1003 *** 14
;1005 *** 12done

;10001 *** 125
;10003 *** 128
;10005 *** 124done

;100001 *** 1396
;100003 *** 2033
;100005 *** 1362done

;1000001 *** 13860
;1000003 *** 16022
;1000005 *** 13820done