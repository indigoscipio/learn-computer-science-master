;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-beginner-reader.ss" "lang")((modname exercise-47) (read-case-sensitive #t) (teachpacks ((lib "convert.rkt" "teachpack" "htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "batch-io.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "convert.rkt" "teachpack" "htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "batch-io.rkt" "teachpack" "2htdp")) #f)))
(define HAPPINESS-LEVEL-BASE 100)
(define HAPPINESS-BAR-WIDTH 100)
(define HAPPINESS-BAR-HEIGHT 25)
(define BACKGROUND
  (rectangle 500 500 "outline" "black")
  )

(define happiness-bar
  (rectangle HAPPINESS-BAR-WIDTH HAPPINESS-BAR-HEIGHT "solid" "red")
  )

(define (happiness-bar-controller happiness-level)
  (rectangle happiness-level HAPPINESS-BAR-HEIGHT "solid" "red")
  )



(define (tock ws)
  (if (<= ws 0)
      ws
 (- ws 0.1)
      )
  )


(define (render ws)
  (happiness-bar-controller ws)
  )

(define (change ws a-key)
  (cond
    [(key=? a-key "down") (- ws (/ 1 5) ) ]
    [(key=? a-key "up") (+ ws (/ 1 3) ) ]
    [else ws])
  )

(define (cat-prog ws)
  (big-bang ws
  [on-tick tock]
  [to-draw render]
  [on-key change]
    ))
(cat-prog 100)