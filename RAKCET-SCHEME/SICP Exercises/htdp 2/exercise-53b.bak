;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-beginner-reader.ss" "lang")((modname exercise-53b) (read-case-sensitive #t) (teachpacks ((lib "convert.rkt" "teachpack" "htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "batch-io.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "convert.rkt" "teachpack" "htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "batch-io.rkt" "teachpack" "2htdp")) #f)))
; Constants
(define WORLD-WIDTH 250)
(define WORLD-HEIGHT 100)
(define ROCKET-HEIGHT 30)
(define ROCKET-WIDTH 10)
(define GROUND-POINT (- WORLD-HEIGHT ROCKET-HEIGHT))
(define BACKGROUND (rectangle WORLD-WIDTH WORLD-HEIGHT "outline" "black"))
(define ROCKET (rectangle ROCKET-WIDTH ROCKET-HEIGHT "solid" "red"))
(define YDELTA 3)
(define ROCKET-CENTER (/ ROCKET-HEIGHT 2))



(define (tock ws)
  ; if ws is resting, return ws / don't tick
  (if (equal? ws "resting")
      ws
      (- ws YDELTA)
      )
  ; otherwise ws -3
  )

(define (render ws)
  ; if ws is resting, render the rocket at the ground
  (if (equal? ws "resting")
      (place-image ROCKET (/ WORLD-WIDTH 2) GROUND-POINT BACKGROUND )
  ; otherwise, rocket is launched ws - 3
      (place-image ROCKET (/ WORLD-WIDTH 2) ws BACKGROUND )
      )
  )

(define (change ws ke)
  ; if the spacebar key event is pressed, launch the rocket
  (cond
    [(key=? ke " ") GROUND-POINT ]
    ;else continue resting
    [else ws]
        )
  )

; LRCD -> Image
; renders the state as a resting or flying rocket 
(define (show x)
  (place-image ROCKET ) )
 
; LRCD KeyEvent -> LRCD
; starts the countdown when space bar is pressed, 
; if the rocket is still resting 
(define (launch x ke)
  x)
 
; LRCD -> LRCD
; raises the rocket by YDELTA,
;  if it is moving already 
(define (fly x)
  x)

;LRCR is one of the following:
; "resting", numb between -3 and -1, a nonnegative number
(define (launch-rocket ws)
  (big-bang ws
            [on-tick tock]
            [to-draw render]
            [on-key change]
       )
  )
(launch-rocket "resting")